<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redactor</title>
    <!-- CodeMirror CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material-darker.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css"
    />

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="theme-init.js"></script>
    <style>
      /* Custom scrollbar styles */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      /* Light theme scrollbar */
      ::-webkit-scrollbar-track {
        background: #e5e7eb;
      }
      ::-webkit-scrollbar-thumb {
        background: #9ca3af;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #6b7280;
      }
      /* Dark theme scrollbar */
      .dark ::-webkit-scrollbar-track {
        background: #1f2937;
      }
      .dark ::-webkit-scrollbar-thumb {
        background: #4b5563;
      }
      .dark ::-webkit-scrollbar-thumb:hover {
        background: #6b7280;
      }

      /* Hide scrollbar for the tabs container */
      #tabs-container::-webkit-scrollbar {
        display: none;
      }
      /* Simple splitter styling */
      .splitter {
        flex: 0 0 5px;
        cursor: col-resize;
        z-index: 10;
      }
      /* Prevents text selection during UI interactions */
      .select-none {
        user-select: none;
      }
      /* Custom checkbox style */
      input[type="checkbox"] {
        appearance: none;
        width: 1.25rem;
        height: 1.25rem;
        border-radius: 0.25rem;
        display: grid;
        place-content: center;
        cursor: pointer;
      }
      input[type="checkbox"]::before {
        content: "";
        width: 0.75rem;
        height: 0.75rem;
        transform: scale(0);
        transition: 120ms transform ease-in-out;
        box-shadow: inset 1em 1em #3b82f6;
        transform-origin: bottom left;
        clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
      }
      input[type="checkbox"]:checked::before {
        transform: scale(1);
      }
      /* CodeMirror styles */
      .CodeMirror {
        height: 100%;
        font-size: 14px;
        border-radius: 0.375rem;
      }
      .CodeMirror-placeholder {
        color: #9ca3af !important;
      }
      .dark .CodeMirror-placeholder {
        color: #6b7280 !important;
      }
    </style>
  </head>
  <body
    class="bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-200 font-sans h-screen flex flex-col transition-colors duration-300 pb-8"
  >
    <!-- Tab Bar -->
    <div
      id="tab-bar"
      class="flex items-center bg-gray-100 dark:bg-gray-900 px-2 select-none border-b border-gray-300 dark:border-gray-700"
    >
      <button
        id="scroll-left-button"
        class="hidden p-1 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors duration-150"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <div id="tabs-wrapper" class="flex-grow overflow-hidden">
        <div
          id="tabs-container"
          class="flex items-end overflow-x-auto scroll-smooth"
        >
          <!-- Tabs and the add button will be dynamically inserted here -->
        </div>
      </div>
      <button
        id="scroll-right-button"
        class="hidden p-1 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors duration-150"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
      <button
        id="settings-button"
        title="Redaction Settings"
        class="ml-4 p-1 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors duration-150"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="12" cy="12" r="3"></circle>
          <path
            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
          ></path>
        </svg>
      </button>
    </div>

    <div id="container" class="flex-grow flex w-full overflow-hidden px-4 pt-4">
      <!-- Input Panel -->
      <div id="left-panel" class="flex flex-col w-1/2 h-full p-2">
        <div class="flex justify-between items-center mb-2">
          <label class="text-lg font-semibold">Original Data</label>
          <div class="flex items-center space-x-2">
            <span
              id="detected-format"
              class="text-sm bg-gray-200 dark:bg-gray-700 px-2 py-1 rounded"
            ></span>
          </div>
        </div>
        <div id="input-editor" class="flex-grow overflow-hidden"></div>
      </div>

      <div
        id="splitter"
        class="splitter bg-gray-300 dark:bg-gray-600 h-full"
      ></div>

      <!-- Output Panel -->
      <div id="right-panel" class="flex flex-col w-1/2 h-full p-2">
        <div class="flex items-center justify-between mb-2">
          <label class="text-lg font-semibold">Redacted Data</label>
          <button
            id="copy-button"
            title="Copy to clipboard"
            class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-150 p-1 rounded-md"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path
                d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
              ></path>
            </svg>
          </button>
        </div>
        <div id="output-editor" class="flex-grow overflow-hidden"></div>
      </div>
    </div>

    <div class="flex justify-end px-6 py-4">
      <button
        id="redact-button"
        class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg text-lg transition duration-200"
      >
        Redact
      </button>
    </div>

    <!-- Error Toast -->
    <div
      id="error-toast"
      class="hidden fixed bottom-5 right-5 bg-red-600 text-white py-2 px-4 rounded-lg shadow-lg"
    >
      <span id="error-message"></span>
    </div>

    <!-- Powered by Label -->
    <div
      class="fixed bottom-1 right-2 text-xs text-gray-500 dark:text-gray-400"
    >
      Found any bugs? Please submit an issue to
      <a
        href="https://github.com"
        target="_blank"
        class="underline hover:text-blue-500 dark:hover:text-blue-400"
        >GitHub</a
      >. Powered by Refactor Security
    </div>

    <!-- Settings Modal -->
    <div
      id="settings-modal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
    >
      <div
        class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-lg border border-gray-300 dark:border-gray-700"
      >
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold">Settings</h2>
          <button
            id="close-settings-button"
            class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white text-3xl font-light"
          >
            &times;
          </button>
        </div>

        <div class="space-y-6">
          <!-- Redacting Settings -->
          <div>
            <h3
              class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-2"
            >
              Redacting Settings
            </h3>
            <div class="space-y-4 pl-2">
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="setting-redact-url-path"
                  class="bg-gray-300 dark:bg-gray-600"
                />
                <span class="ml-3">Redact URL path</span>
              </label>
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="setting-redact-query-string"
                  class="bg-gray-300 dark:bg-gray-600"
                  checked
                />
                <span class="ml-3">Redact query string values</span>
              </label>
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="setting-redact-param-names"
                  class="bg-gray-300 dark:bg-gray-600"
                />
                <span class="ml-3">Redact parameter names</span>
              </label>
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="setting-redact-cookies"
                  class="bg-gray-300 dark:bg-gray-600"
                  checked
                />
                <span class="ml-3"
                  >Redact cookie/auth values (preserves names)</span
                >
              </label>
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="setting-redact-csrf"
                  class="bg-gray-300 dark:bg-gray-600"
                  checked
                />
                <span class="ml-3">Redact CSRF tokens (in headers & body)</span>
              </label>
              <div>
                <label
                  for="setting-ignored-words"
                  class="block mb-2 text-sm font-medium"
                  >Ignored Words (comma-separated)</label
                >
                <textarea
                  id="setting-ignored-words"
                  rows="3"
                  class="w-full p-2 bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 focus:outline-none text-sm"
                  placeholder="e.g. Bearer, token, secret"
                ></textarea>
              </div>
            </div>
          </div>

          <!-- UI Settings -->
          <div>
            <h3
              class="text-lg font-semibold mb-3 border-b border-gray-300 dark:border-gray-600 pb-2"
            >
              UI Settings
            </h3>
            <div class="space-y-3 pl-2">
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="setting-dark-theme"
                  class="bg-gray-300 dark:bg-gray-600"
                />
                <span class="ml-3">Use Dark Theme</span>
              </label>
              <label class="flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  id="setting-syntax-highlight"
                  class="bg-gray-300 dark:bg-gray-600"
                  checked
                />
                <span class="ml-3">Enable Syntax Highlighting</span>
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- CodeMirror Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/http/http.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/yaml/yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/display/placeholder.min.js"></script>

    <script src="app.js"></script>
  </body>
</html>
